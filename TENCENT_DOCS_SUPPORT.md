# 📋 腾讯文档表单支持说明

## 🎉 新功能

现在应用已经支持**腾讯文档表单**（docs.qq.com/form）的自动填写！

## ✨ 特性

### 1. 自动检测表单类型

应用会自动识别当前表单的类型：
- ✅ 腾讯文档表单 (docs.qq.com/form)
- ✅ 麦客CRM表单 (mikecrm.com)

### 2. 智能字段匹配

腾讯文档填写引擎支持：
- **精确匹配**：字段名称完全一致
- **模糊匹配**：字段名称包含关键词
- **自动处理**：自动移除 `disabled` 和 `readonly` 属性

### 3. 详细的填写反馈

- ✅ 显示成功填写的字段数量
- ✅ 列出具体填写的字段名称
- ✅ 提供详细的控制台日志

## 🚀 使用方法

### 步骤 1：配置名片数据

在"名片管理"中创建或编辑名片，添加字段配置，例如：

```
手机号【着急时联系】 = 13800138000
微信 = weixin123
抖音昵称 = 测试账号
抖音账号 = test123456
粉丝数量 = 10000
主页链接 = https://example.com/profile
赞藏量 = 5000
所在地 = 北京
（自行报价） = 300
账号类型 = 母婴
```

### 步骤 2：添加腾讯文档表单链接

在"链接管理"中添加腾讯文档表单的 URL，例如：

```
https://docs.qq.com/form/page/DV0JwTG9BTmJIZWNr
```

### 步骤 3：执行自动填写

1. 打开"自动填写"窗口
2. 在左侧选择名片
3. 在下方选择腾讯文档表单链接
4. 点击"✏️ 自动填写"按钮
5. 等待填写完成

## 🔍 诊断功能

如果填写失败，可以使用"🔍 诊断页面"功能：

1. 点击工具栏的"🔍 诊断页面"按钮
2. 查看诊断结果，了解页面上的问题数量和类型
3. 在控制台查看详细的问题信息

诊断会显示：
- 问题总数
- 前5个问题的标题和是否必填
- 详细的控制台输出

## 📊 字段匹配规则

### 精确匹配示例

| 表单字段名 | 名片字段名 | 匹配结果 |
|-----------|-----------|---------|
| 手机号【着急时联系】 | 手机号【着急时联系】 | ✅ 精确匹配 |
| 微信 | 微信 | ✅ 精确匹配 |

### 模糊匹配示例

| 表单字段名 | 名片字段名 | 匹配结果 |
|-----------|-----------|---------|
| 手机号【着急时联系】 | 手机号 | ✅ 包含匹配 |
| （自行报价） | 自行报价 | ✅ 包含匹配 |
| 抖音昵称 | 昵称 | ✅ 包含匹配 |

## ⚙️ 技术细节

### 腾讯文档表单DOM结构

```html
<div class="question" data-qid="..." data-type="simple">
  <div class="question-main">
    <div class="question-title">
      <span class="form-auto-ellipsis">手机号【着急时联系】</span>
    </div>
    <div class="question-content">
      <textarea disabled="" placeholder="未填写"></textarea>
    </div>
  </div>
</div>
```

### 填写流程

1. **等待页面加载**：最多等待5秒，直到找到问题元素
2. **遍历所有问题**：查询所有 `.question[data-qid]` 元素
3. **提取问题标题**：从 `.question-title .form-auto-ellipsis` 获取
4. **字段匹配**：在名片配置中查找匹配的字段
5. **启用输入框**：移除 `disabled` 和 `readonly` 属性
6. **填写值**：设置 `value` 并触发 `input`, `change`, `blur` 事件
7. **返回结果**：统计成功和失败的字段

## 🐛 常见问题

### Q1: 为什么有些字段没有填写？

**可能原因：**
- 字段名称不匹配（检查名片配置中的字段名是否与表单一致）
- 页面还未完全加载（等待更长时间或刷新页面）
- 字段类型不支持（当前仅支持文本输入框）

**解决方法：**
1. 使用"🔍 诊断页面"查看表单结构
2. 调整名片配置中的字段名，使其与表单标题匹配
3. 查看控制台日志了解详细错误信息

### Q2: 如何查看详细的填写日志？

在控制台中会输出详细的日志，包括：
- ⏳ 页面加载状态
- 📝 每个问题的标题
- ✅ 匹配成功的字段
- ⚠️ 未找到匹配的字段
- ✓ 填写成功的字段

### Q3: 支持哪些类型的输入框？

当前版本支持：
- ✅ `<textarea>` 文本输入框
- ✅ 简答题 (data-type="simple")

未来计划支持：
- ⏳ 单选题
- ⏳ 多选题
- ⏳ 下拉选择

## 🔄 版本历史

### v1.0.0 (当前版本)
- ✅ 支持腾讯文档表单自动填写
- ✅ 自动检测表单类型
- ✅ 精确和模糊字段匹配
- ✅ 腾讯文档专用诊断功能
- ✅ 详细的填写反馈

## 📞 技术支持

如果遇到问题，请：
1. 查看控制台输出
2. 使用诊断功能分析页面结构
3. 检查字段名称是否匹配
4. 查看本文档的常见问题部分

---

**祝您使用愉快！** 🎉





